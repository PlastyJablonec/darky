<!DOCTYPE html>
<html>
<head>
    <title>D√°rekList Test</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>D√°rekList Test</h1>
    <div id="status"></div>
    <div id="result"></div>
    
    <script>
        const { createClient } = supabase;
        const supabaseClient = createClient(
            'https://dkqcgmwqugsvlobzekwo.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcWNnbXdxdWdzdmxvYnpla3dvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAzNTg5OTcsImV4cCI6MjA2NTkzNDk5N30.FwT2G_SE-YDgvl8MDRFvA4EcfeujCcTIS5AgouiCXtE'
        );
        
        async function testApp() {
            const statusDiv = document.getElementById('status');
            const resultDiv = document.getElementById('result');
            
            statusDiv.innerHTML = 'Testov√°n√≠...';
            
            try {
                // Test p≈ôihl√°≈°en√≠
                statusDiv.innerHTML = 'P≈ôihla≈°ov√°n√≠...';
                const { data: authData, error: authError } = await supabaseClient.auth.signInWithPassword({
                    email: 'vondracek.ivan@gmail.com',
                    password: 'navi2633'
                });
                
                if (authError) {
                    throw new Error('Auth: ' + authError.message);
                }
                
                statusDiv.innerHTML = '‚úÖ P≈ôihl√°≈°en jako: ' + authData.user.email;
                
                // Test vytvo≈ôen√≠ seznamu
                statusDiv.innerHTML = 'Vytv√°≈ôen√≠ seznamu...';
                const { data: wishlistData, error: wishlistError } = await supabaseClient
                    .from('wishlists')
                    .insert({
                        user_id: authData.user.id,
                        title: 'Browser Test Seznam',
                        description: 'Test z prohl√≠≈æeƒçe',
                        is_public: false
                    })
                    .select()
                    .single();
                
                if (wishlistError) {
                    throw new Error('Wishlist: ' + wishlistError.message);
                }
                
                statusDiv.innerHTML = '‚úÖ Seznam vytvo≈ôen!';
                resultDiv.innerHTML = '<pre>' + JSON.stringify(wishlistData, null, 2) + '</pre>';
                
                // Test p≈ôid√°n√≠ d√°rku
                const { data: giftData, error: giftError } = await supabaseClient
                    .from('gifts')
                    .insert({
                        wishlist_id: wishlistData.id,
                        title: 'Test D√°rek',
                        description: 'Test d√°rek z prohl√≠≈æeƒçe',
                        price: 1000,
                        priority: 'medium'
                    })
                    .select()
                    .single();
                
                if (giftError) {
                    throw new Error('Gift: ' + giftError.message);
                }
                
                statusDiv.innerHTML = 'üéâ V≈°e funguje! Seznam i d√°rek vytvo≈ôeny!';
                resultDiv.innerHTML += '<h3>D√°rek:</h3><pre>' + JSON.stringify(giftData, null, 2) + '</pre>';
                
            } catch (error) {
                statusDiv.innerHTML = '‚ùå Chyba: ' + error.message;
                resultDiv.innerHTML = '<pre>' + error.stack + '</pre>';
            }
        }
        
        // Spustit test automaticky
        testApp();
    </script>
</body>
</html>